<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Live Scoreboard — Slide</title>
<link rel="icon" href="data:,">
<style>
  :root{--bg:#071122;--panel:rgba(255,255,255,0.04);--accent:#ffd166;--muted:rgba(255,255,255,0.55);}
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans","Helvetica Neue",Arial;}
  body{background:linear-gradient(180deg,#041022 0%, #071122 100%);color:#fff;display:flex;flex-direction:column}
  .wrap{max-width:1200px;margin:18px auto;padding:18px;flex:1;display:flex;flex-direction:column;gap:12px}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between}
  h1{margin:0;font-size:26px}
  .controls{display:flex;gap:8px;align-items:center}
  input[type=text],input[type=number]{padding:8px 10px;border-radius:8px;border:0;background:rgba(255,255,255,0.04);color:#fff;min-width:220px}
  button{background:var(--accent);border:0;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
  .main{display:flex;gap:16px;align-items:flex-start}
  .panel{background:var(--panel);border-radius:12px;padding:12px;flex:1}
  .table{display:grid;gap:8px}
  .row{display:grid;grid-template-columns:72px 1fr 120px 140px;align-items:center;padding:10px;border-radius:8px;background:rgba(0,0,0,0.15)}
  .headerRow{opacity:0.8;font-size:13px}
  .name{font-size:18px;font-weight:700}
  .rank{font-weight:900;font-size:20px}
  .podium{display:flex;justify-content:center;gap:18px;align-items:flex-end}
  .podCard{width:260px;border-radius:12px;overflow:hidden}
  .podTop{padding:14px;text-align:center}
  .podBar{height:120px;display:flex;align-items:center;justify-content:center;font-size:42px;font-weight:900;background:rgba(255,255,255,0.05)}
  .small{font-size:12px;opacity:0.8}
  .muted{color:var(--muted)}
  .footer{font-size:12px;color:var(--muted)}
  .inline{display:inline-flex;gap:8px;align-items:center}
  .fullscreenBtn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff;padding:8px;border-radius:8px;cursor:pointer}
  @media (max-width:900px){ .row{grid-template-columns:48px 1fr 90px 110px} .podCard{width:180px} }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>Live Scoreboard — slide（投影模式）</h1>
      <div class="small muted">从 Google Sheet: slide (gid=1170886723) 实时读取 · 自动刷新</div>
    </div>

    <div class="controls">
      <input id="csvUrl" type="text" placeholder="CSV 链接（或留空使用默认）" />
      <button id="loadBtn">读取/刷新</button>
      <label class="inline">
        刷新间隔
        <input id="interval" type="number" value="5" min="1" style="width:64px;padding:6px 8px;border-radius:8px"/>
        s
      </label>
      <button id="toggleView" title="切换列表/颁奖台">切换视图</button>
      <button id="fullBtn" class="fullscreenBtn">全屏</button>
    </div>
  </header>

  <div class="main">
    <div class="panel" style="flex:2">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div class="small muted">条目: <span id="count">0</span></div>
        <div class="small muted">上次更新: <span id="updated">—</span></div>
      </div>

      <div id="listView">
        <div class="headerRow row" style="background:transparent">
          <div>名次</div><div>队伍</div><div style="text-align:right">原始分</div><div style="text-align:right">最终分</div>
        </div>
        <div id="rows" class="table"></div>
      </div>

      <div id="podiumView" style="display:none">
        <div class="podium" id="podium"></div>
      </div>
    </div>

    <div class="panel" style="width:360px">
      <div style="font-weight:800;margin-bottom:8px">设置 & 说明</div>
      <div class="small muted" style="margin-bott
